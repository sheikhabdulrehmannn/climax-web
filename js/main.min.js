class ClimaxHosiery{constructor(){this.init();this.initMobileScrollEnhancements();this.initDynamicContentScaling()}init(){this.setupEventListeners();this.setupScrollAnimations();this.setupHeaderScrollEffect();this.setupMobileMenu();this.setupProductFilters();this.setupContactForm();this.setupGallery();this.animateStats();this.setupYarnAnimation()}initMobileScrollEnhancements(){this.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent);if(this.isMobile){this.setupMobileScrollBehavior();this.setupTouchScrollOptimization()}}setupMobileScrollBehavior(){const smoothScrollLinks=document.querySelectorAll('a[href^="#"]');smoothScrollLinks.forEach(link=>{link.addEventListener('click',e=>{e.preventDefault();const targetId=link.getAttribute('href');const targetElement=document.querySelector(targetId);if(targetElement){this.smoothScrollToElement(targetElement)}})})}smoothScrollToElement(element){const headerHeight=document.querySelector('.header')?.offsetHeight||80;const targetPosition=element.offsetTop-headerHeight;if('scrollBehavior'in document.documentElement.style){window.scrollTo({top:targetPosition,behavior:'smooth'})}else{this.customSmoothScroll(targetPosition)}}customSmoothScroll(targetPosition){const startPosition=window.pageYOffset;const distance=targetPosition-startPosition;const duration=800;let start=null;const animation=currentTime=>{if(start===null)start=currentTime;const timeElapsed=currentTime-start;const run=this.easeInOutQuad(timeElapsed,startPosition,distance,duration);window.scrollTo(0,run);if(timeElapsed<duration)requestAnimationFrame(animation)};requestAnimationFrame(animation)}easeInOutQuad(t,b,c,d){t/=d/2;if(t<1)return c/2*t*t+b;t--;return-c/2*(t*(t-2)-1)+b}setupTouchScrollOptimization(){let isScrolling=false;window.addEventListener('touchstart',()=>{isScrolling=true},{passive:true});window.addEventListener('touchend',()=>{isScrolling=false},{passive:true});if(this.isIOS){document.body.addEventListener('touchmove',e=>{if(!isScrolling){e.preventDefault()}},{passive:false})}}initDynamicContentScaling(){this.viewport={width:window.innerWidth,height:window.innerHeight};this.setupViewportTracking();this.calculateOptimalScaling();this.applyDynamicScaling();let resizeTimeout;window.addEventListener('resize',()=>{clearTimeout(resizeTimeout);resizeTimeout=setTimeout(()=>{this.updateViewport();this.calculateOptimalScaling();this.applyDynamicScaling()},150)});window.addEventListener('orientationchange',()=>{setTimeout(()=>{this.updateViewport();this.calculateOptimalScaling();this.applyDynamicScaling()},300)})}setupViewportTracking(){if('visualViewport'in window){window.visualViewport.addEventListener('resize',()=>{this.updateViewport();this.calculateOptimalScaling()})}}updateViewport(){this.viewport={width:window.innerWidth,height:window.innerHeight,ratio:window.innerWidth/window.innerHeight}}calculateOptimalScaling(){const{width,height}=this.viewport;this.scalingConfig={mobile:{maxWidth:768,heroScale:this.calculateHeroScale(width,height,'mobile'),sectionScale:this.calculateSectionScale(width,height,'mobile'),textScale:this.calculateTextScale(width,'mobile')},tablet:{maxWidth:1024,heroScale:this.calculateHeroScale(width,height,'tablet'),sectionScale:this.calculateSectionScale(width,height,'tablet'),textScale:this.calculateTextScale(width,'tablet')},desktop:{heroScale:this.calculateHeroScale(width,height,'desktop'),sectionScale:this.calculateSectionScale(width,height,'desktop'),textScale:this.calculateTextScale(width,'desktop')}}}calculateHeroScale(width,height,device){const baseHeight=device==='mobile'?.7:device==='tablet'?.75:.85;const aspectRatio=width/height;let scaleFactor=baseHeight;if(aspectRatio>1.5){scaleFactor*=.9}else if(aspectRatio<.8){scaleFactor*=1.1}return Math.max(.6,Math.min(.9,scaleFactor))}calculateSectionScale(width,height,device){const baseScale=device==='mobile'?.45:device==='tablet'?.55:.6;const contentDensity=height/800;return Math.max(.3,Math.min(.8,baseScale*contentDensity))}calculateTextScale(width,device){const baseSize=device==='mobile'?16:device==='tablet'?18:20;const widthFactor=Math.min(width/320,2);return Math.max(.8,Math.min(1.5,widthFactor))}applyDynamicScaling(){const{width}=this.viewport;let currentConfig;if(width<=768){currentConfig=this.scalingConfig.mobile}else if(width<=1024){currentConfig=this.scalingConfig.tablet}else{currentConfig=this.scalingConfig.desktop}this.applyHeroScaling(currentConfig.heroScale);this.applySectionScaling(currentConfig.sectionScale);this.applyTextScaling(currentConfig.textScale);this.ensureContentVisibility()}applyHeroScaling(scale){const heroSection=document.querySelector('.hero');if(heroSection){const scaledHeight=this.viewport.height*scale;heroSection.style.minHeight=`${scaledHeight}px`;const heroContent=heroSection.querySelector('.hero-content');if(heroContent){const contentScale=Math.max(.8,Math.min(1.2,scale));heroContent.style.transform=`scale(${contentScale})`}}}applySectionScaling(scale){const dynamicSections=document.querySelectorAll('.section');dynamicSections.forEach(section=>{if(!section.classList.contains('hero')){const scaledHeight=this.viewport.height*scale;section.style.minHeight=`${Math.max(300,scaledHeight)}px`}})}applyTextScaling(scale){document.documentElement.style.setProperty('--dynamic-text-scale',scale);const scalableElements=document.querySelectorAll('.hero-title, .hero-tagline, .section-title');scalableElements.forEach(element=>{const currentFontSize=window.getComputedStyle(element).fontSize;const baseFontSize=parseFloat(currentFontSize);element.style.fontSize=`${baseFontSize*scale}px`})}ensureContentVisibility(){const firstSection=document.querySelector('.hero');const secondSection=document.querySelector('.section:not(.hero)');if(firstSection&&secondSection){const firstSectionHeight=firstSection.offsetHeight;const secondSectionHeight=secondSection.offsetHeight;const availableHeight=this.viewport.height;const requiredHeight=firstSectionHeight+secondSectionHeight*.5;if(requiredHeight>availableHeight){const adjustment=(requiredHeight-availableHeight)/availableHeight;const newFirstSectionHeight=firstSectionHeight*(1-adjustment*.5);firstSection.style.minHeight=`${Math.max(300,newFirstSectionHeight)}px`}}}getScalingInfo(){return{viewport:this.viewport,scalingConfig:this.scalingConfig,isMobile:this.isMobile,isIOS:this.isIOS}}setupEventListeners(){document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener('click',e=>{e.preventDefault();const target=document.querySelector(anchor.getAttribute('href'));if(target){target.scrollIntoView({behavior:'smooth',block:'start'})}})});document.querySelectorAll('a[href$=".html"]').forEach(link=>{link.addEventListener('click',e=>{if(!e.ctrlKey&&!e.metaKey){this.showPageTransition()}})})}setupScrollAnimations(){const observerOptions={threshold:.1,rootMargin:'0px 0px -50px 0px'};const observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add('visible')}})},observerOptions);document.querySelectorAll('.fade-in, .slide-in-left, .slide-in-right').forEach(el=>{observer.observe(el)})}setupHeaderScrollEffect(){const header=document.querySelector('.header');if(!header)return;let lastScrollY=window.scrollY;window.addEventListener('scroll',()=>{const currentScrollY=window.scrollY;if(currentScrollY>100){header.classList.add('scrolled')}else{header.classList.remove('scrolled')}lastScrollY=currentScrollY})}setupMobileMenu(){const mobileBtn=document.querySelector('.mobile-menu-btn');const nav=document.querySelector('.nav');if(!mobileBtn||!nav)return;mobileBtn.addEventListener('click',()=>{nav.classList.toggle('open');const isOpen=nav.classList.contains('open');mobileBtn.setAttribute('aria-expanded',isOpen);mobileBtn.innerHTML=isOpen?'✕':'☰'});document.addEventListener('click',e=>{if(!nav.contains(e.target)&&!mobileBtn.contains(e.target)){nav.classList.remove('open');mobileBtn.setAttribute('aria-expanded','false');mobileBtn.innerHTML='☰'}})}setupProductFilters(){const filterBtns=document.querySelectorAll('.filter-btn');const productCards=document.querySelectorAll('.product-card');if(!filterBtns.length||!productCards.length)return;filterBtns.forEach(btn=>{btn.addEventListener('click',()=>{const filter=btn.getAttribute('data-filter');filterBtns.forEach(b=>b.classList.remove('active'));btn.classList.add('active');productCards.forEach(card=>{if(filter==='all'||card.getAttribute('data-category')===filter){card.style.display='block';setTimeout(()=>card.classList.add('visible'),50)}else{card.classList.remove('visible');setTimeout(()=>card.style.display='none',300)}})})})}setupContactForm(){const contactForm=document.getElementById('contactForm');if(!contactForm)return;contactForm.addEventListener('submit',async e=>{e.preventDefault();const submitBtn=contactForm.querySelector('button[type="submit"]');const originalText=submitBtn.innerHTML;submitBtn.innerHTML='<span class="loader"></span> Sending...';submitBtn.disabled=true;setTimeout(()=>{this.showSuccessMessage('Thank you! Your message has been sent successfully.');contactForm.reset();submitBtn.innerHTML=originalText;submitBtn.disabled=false},2000)});const requiredFields=contactForm.querySelectorAll('[required]');requiredFields.forEach(field=>{field.addEventListener('blur',()=>this.validateField(field));field.addEventListener('input',()=>this.clearFieldError(field))})}validateField(field){const isValid=field.checkValidity();const errorElement=field.parentNode.querySelector('.field-error');if(!isValid){field.style.borderColor='#ef4444';if(!errorElement){const error=document.createElement('span');error.className='field-error';error.style.color='#ef4444';error.style.fontSize='.875rem';error.textContent=field.validationMessage;field.parentNode.appendChild(error)}}else{this.clearFieldError(field)}}clearFieldError(field){field.style.borderColor='';const errorElement=field.parentNode.querySelector('.field-error');if(errorElement){errorElement.remove()}}setupGallery(){const galleryItems=document.querySelectorAll('.gallery-item');galleryItems.forEach(item=>{item.addEventListener('click',()=>{const imgSrc=item.querySelector('img')?.src;if(imgSrc){this.openLightbox(imgSrc)}})})}openLightbox(imageSrc){const lightbox=document.createElement('div');lightbox.className='lightbox';lightbox.style.cssText=`position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:10000;cursor:pointer;`;const img=document.createElement('img');img.src=imageSrc;img.style.cssText=`max-width:90%;max-height:90%;object-fit:contain;border-radius:var(--border-radius);`;lightbox.appendChild(img);document.body.appendChild(lightbox);lightbox.addEventListener('click',()=>{document.body.removeChild(lightbox)});const handleEscape=e=>{if(e.key==='Escape'){document.body.removeChild(lightbox);document.removeEventListener('keydown',handleEscape)}};document.addEventListener('keydown',handleEscape)}animateStats(){const statNumbers=document.querySelectorAll('.stat-number');statNumbers.forEach(stat=>{const target=parseInt(stat.textContent.replace(/[^\d]/g,''));const duration=2000;const increment=target/(duration/16);let current=0;const updateStat=()=>{current+=increment;if(current<target){stat.textContent=Math.floor(current).toLocaleString();requestAnimationFrame(updateStat)}else{stat.textContent=target.toLocaleString()+'+'}};const observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){updateStat();observer.disconnect()}})});observer.observe(stat)})}setupYarnAnimation(){const yarnContainer=document.querySelector('.yarn-animation');if(!yarnContainer)return;const svg=document.createElementNS('http://www.w3.org/2000/svg','svg');svg.setAttribute('viewBox','0 0 300 300');svg.setAttribute('width','100%');svg.setAttribute('height','100%');const path=document.createElementNS('http://www.w3.org/2000/svg','path');path.setAttribute('d','M150,50 Q250,100 150,150 Q50,200 150,250 Q250,200 150,150');path.setAttribute('fill','none');path.setAttribute('stroke','var(--primary-red)');path.setAttribute('stroke-width','3');path.setAttribute('opacity','0.6');const animateTag=document.createElementNS('http://www.w3.org/2000/svg','animateTransform');animateTag.setAttribute('attributeName','transform');animateTag.setAttribute('type','rotate');animateTag.setAttribute('values','0 150 150; 360 150 150');animateTag.setAttribute('dur','20s');animateTag.setAttribute('repeatCount','indefinite');path.appendChild(animateTag);svg.appendChild(path);yarnContainer.appendChild(svg)}showPageTransition(){const overlay=document.createElement('div');overlay.style.cssText=`position:fixed;top:0;left:0;right:0;bottom:0;background:var(--primary-red);z-index:9999;display:flex;align-items:center;justify-content:center;color:var(--white);font-size:1.2rem;transition:opacity 0.3s ease;`;overlay.innerHTML='<span class="loader"></span>';document.body.appendChild(overlay);setTimeout(()=>{overlay.style.opacity='0';setTimeout(()=>{if(document.body.contains(overlay)){document.body.removeChild(overlay)}},300)},800)}showSuccessMessage(message){const toast=document.createElement('div');toast.style.cssText=`position:fixed;top:20px;right:20px;background:#10b981;color:white;padding:var(--spacing-3) var(--spacing-4);border-radius:var(--border-radius);box-shadow:var(--shadow-lg);z-index:10000;transform:translateX(400px);transition:var(--transition);`;toast.textContent=message;document.body.appendChild(toast);setTimeout(()=>{toast.style.transform='translateX(0)'},100);setTimeout(()=>{toast.style.transform='translateX(400px)';setTimeout(()=>{if(document.body.contains(toast)){document.body.removeChild(toast)}},300)},4000)}setActiveNavLink(){const currentPage=window.location.pathname.split('/').pop()||'index.html';const navLinks=document.querySelectorAll('.nav-link');navLinks.forEach(link=>{link.classList.remove('active');if(link.getAttribute('href')===currentPage){link.classList.add('active')}})}}document.addEventListener('DOMContentLoaded',()=>{window.climaxHosiery=new ClimaxHosiery;window.climaxHosiery.setActiveNavLink()});document.addEventListener('DOMContentLoaded',()=>{const images=document.querySelectorAll('img[data-src]');const imageObserver=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){const img=entry.target;img.src=img.dataset.src;img.removeAttribute('data-src');imageObserver.unobserve(img)}})});images.forEach(img=>imageObserver.observe(img))});document.addEventListener('DOMContentLoaded',()=>{const criticalImages=['./assets/images/logo.png','./assets/images/hero-bg.jpg'];criticalImages.forEach(src=>{const link=document.createElement('link');link.rel='preload';link.as='image';link.href=src;document.head.appendChild(link)})});